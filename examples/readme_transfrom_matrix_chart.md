 **VTK Transform / Matrix é€ŸæŸ¥è¡¨ï¼ˆå·¥ç¨‹å®žæˆ˜ç‰ˆï¼‰**ã€‚
ä½ å¯ä»¥æŠŠå®ƒå½“æˆâ€œ**ä¸ç”¨å†æƒ³ç¬¬äºŒéçš„è§„åˆ™**â€ã€‚

------

# ðŸ§­ VTK Transform / Matrix é€ŸæŸ¥è¡¨ï¼ˆå¼ºçƒˆæŽ¨èæ”¶è—ï¼‰

------

## ä¸€ã€æ ¸å¿ƒä¸€å¥è¯åŽŸåˆ™ï¼ˆæœ€é‡è¦ï¼‰

> **Matrix å®šä¹‰â€œåæ ‡ç³»â€**
> **Translate å®šä¹‰â€œä½ç½®â€**
> **Pre / Post å†³å®šâ€œä¸–ç•Œ or å±€éƒ¨â€**

------

## äºŒã€SetMatrix vs Concatenate

| æ–¹æ³•               | åšä»€ä¹ˆ           | ä¼šæ¸…ç©ºå·²æœ‰å˜æ¢ | å— Pre/Post å½±å“ | å…¸åž‹ç”¨é€”         |
| ------------------ | ---------------- | -------------- | ---------------- | ---------------- |
| `SetMatrix(mat)`   | ç›´æŽ¥æ›¿æ¢å†…éƒ¨çŸ©é˜µ | âœ… æ˜¯           | âŒ å¦             | å¤–éƒ¨ç»™å®šå®Œæ•´ä½å§¿ |
| `Concatenate(mat)` | å‚ä¸ŽçŸ©é˜µä¹˜æ³•     | âŒ å¦           | âœ… æ˜¯             | é€æ­¥æž„å»ºå˜æ¢     |

------

## ä¸‰ã€PreMultiply vs PostMultiplyï¼ˆçµé­‚ï¼‰

| æ¨¡å¼                  | æ•°å­¦        | è¯­ä¹‰     | å¸¸è§ç”¨é€”     |
| --------------------- | ----------- | -------- | ------------ |
| `PreMultiply`         | `M = A Ã— M` | ä¸–ç•Œåæ ‡ | æ”¾ç½®ç‰©ä½“     |
| `PostMultiply` (é»˜è®¤) | `M = M Ã— A` | å±€éƒ¨åæ ‡ | ç‰©ä½“è‡ªèº«è¿åŠ¨ |

### è®°å¿†æ³•

- **Pre = World**
- **Post = Local**

------

## å››ã€Translate / Rotate / Scale çš„çœŸå®žå«ä¹‰

### 1ï¸âƒ£ Translate

| å†™æ³•                       | å®žé™…å«ä¹‰               |
| -------------------------- | ---------------------- |
| `PreMultiply + Translate`  | æ²¿ä¸–ç•Œè½´ç§»åŠ¨           |
| `PostMultiply + Translate` | æ²¿ç‰©ä½“è‡ªèº«è½´ç§»åŠ¨       |
| å†™è¿› matrix                | æ²¿ matrix å®šä¹‰çš„è½´ç§»åŠ¨ |

------

### 2ï¸âƒ£ Rotate

| å†™æ³•                    | æ—‹è½¬è½´å‚è€ƒ |
| ----------------------- | ---------- |
| `PreMultiply + Rotate`  | ä¸–ç•Œè½´     |
| `PostMultiply + Rotate` | ç‰©ä½“è‡ªèº«è½´ |

------

### 3ï¸âƒ£ Scale

| å†™æ³•                 | æ•ˆæžœ               |
| -------------------- | ------------------ |
| å†™è¿› matrix          | å®šä¹‰ç‰©ä½“å°ºå¯¸       |
| PostMultiply + Scale | æ²¿ç‰©ä½“è½´ç¼©æ”¾       |
| PreMultiply + Scale  | å°‘ç”¨ï¼ˆå®¹æ˜“åç›´è§‰ï¼‰ |

------

## äº”ã€æŽ¨èçš„â€œæ ‡å‡†å†™æ³•æ¨¡æ¿â€

### âœ… æ¨¡æ¿ 1ï¼šä¸–ç•Œä¸­æ”¾ä¸€ä¸ªç‰©ä½“ï¼ˆæœ€å¸¸è§ï¼‰

```cpp
transform->Identity();
transform->SetMatrix(rotationScaleMatrix);
transform->PreMultiply();
transform->Translate(worldPosition);
```

------

### âœ… æ¨¡æ¿ 2ï¼šç‰©ä½“è‡ªå·±ç§»åŠ¨ / åŠ¨ç”»

```cpp
transform->PostMultiply();   // é»˜è®¤
transform->RotateZ(dAngle);
transform->Translate(step);
```

------

### âœ… æ¨¡æ¿ 3ï¼šå¤–éƒ¨ç³»ç»Ÿç»™çš„å®Œæ•´ä½å§¿

```cpp
transform->SetMatrix(externalPoseMatrix);
// ä¸å†é¢å¤– Translate
```

------

## å…­ã€ä»€ä¹ˆæ—¶å€™ä¸è¦æŠŠå¹³ç§»å†™è¿› matrixï¼Ÿ

âŒ **ä¸æŽ¨è** çš„åœºæ™¯ï¼š

- åŠ¨ç”»
- äº¤äº’
- æŽ¢é’ˆ / ç›¸æœºç§»åŠ¨
- ä¸–ç•Œ / å±€éƒ¨è¯­ä¹‰æ··åˆ

åŽŸå› ï¼š

> matrix çš„å¹³ç§»æ˜¯ **â€œå±€éƒ¨å¹³ç§»â€**ï¼Œéžå¸¸å®¹æ˜“è¸©å‘ã€‚

------

## ä¸ƒã€ä»€ä¹ˆæ—¶å€™å¯ä»¥æŠŠå¹³ç§»å†™è¿› matrixï¼Ÿ

âœ… **åˆç†** çš„åœºæ™¯ï¼š

- CAD / ROS / SLAM å¯¼å…¥
- å·²ç»ç®—å¥½çš„ä¸–ç•ŒçŸ©é˜µ
- ä¸æ‰“ç®—å†æ”¹åŠ¨ transform

------

## å…«ã€å¸¸è§é”™è¯¯å¯¹ç…§è¡¨ï¼ˆè¸©å‘é€ŸæŸ¥ï¼‰

| çŽ°è±¡                        | åŽŸå›               |
| --------------------------- | ----------------- |
| Translate åŽæ–¹å‘ä¸å¯¹        | ç”¨äº† PostMultiply |
| SetMatrix åŽ Translate ä¸å¯¹ | matrix å·²åŒ…å«æ—‹è½¬ |
| å†™è¿› matrix çš„å¹³ç§»åƒâ€œæ­ªçš„â€  | å±€éƒ¨è½´è¢«æ—‹è½¬äº†    |
| çœ‹èµ·æ¥â€œä¹±è·³â€                | Pre / Post æ··ç”¨äº† |

------

## ä¹ã€ä¸€çœ¼åˆ¤æ–­ä½ çŽ°åœ¨è¯¥ç”¨ä»€ä¹ˆ

> **é—®è‡ªå·± 3 ä¸ªé—®é¢˜ï¼š**

1ï¸âƒ£ æˆ‘æ˜¯ä¸æ˜¯å·²ç»æœ‰å®Œæ•´ 4Ã—4 ä½å§¿ï¼Ÿ
â†’ `SetMatrix`

2ï¸âƒ£ æˆ‘è¦çš„æ˜¯ä¸–ç•Œä½ç½®è¿˜æ˜¯ç‰©ä½“è‡ªèº«è¿åŠ¨ï¼Ÿ
â†’ `Pre` / `Post`

3ï¸âƒ£ è¿™ä¸ªå¹³ç§»æ˜¯ä¸æ˜¯ä¼šå˜ï¼Ÿ
â†’ ç”¨ `Translate`ï¼Œä¸è¦å†™è¿› matrix

------

## åã€ä¸€å¥â€œç»ˆæžå£è¯€â€ï¼ˆå¯ä»¥ç›´æŽ¥èƒŒï¼‰

> **SetMatrix å®šä¹‰åæ ‡ç³»**
> **Translate å®šä¹‰ä½ç½®**
> **Pre æ˜¯ä¸–ç•Œï¼ŒPost æ˜¯è‡ªå·±**